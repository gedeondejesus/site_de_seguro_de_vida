{% extends "website/base.html" %}
{% load static %}
{% block title %}Heller Finance | Home{% endblock %}

{% block content %}
<div class="container my-4">

  {% if banners %}
  <div id="heroCarousel" class="carousel slide hero-carousel" data-bs-ride="carousel">

    <div class="carousel-indicators">
      {% for b in banners %}
      <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="{{ forloop.counter0 }}"
              class="{% if forloop.first %}active{% endif %}"></button>
      {% endfor %}
    </div>

    <div class="carousel-inner">
      {% for b in banners %}
      <div class="carousel-item {% if forloop.first %}active{% endif %}">
        <img src="{{ b.image.url }}" class="d-block w-100 hero-img" alt="{{ b.title }}">

        <div class="hero-overlay hero-overlay--mobile">
          <div class="hero-box hero-box--mobile">

            <img class="hero-logo" src="{% static 'website/img/logo.png' %}" alt="Heller Finance">
            <div class="hero-brand">HELLER FINANCE</div>
            <div class="hero-text">
              Protegendo o futuro da sua família<br>
              com estratégia e propósito.
            </div>
            <div class="hero-cta">
              <a class="btn btn-gold" href="/contact/">Agendar uma conversa</a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
  {% else %}
    <div class="alert alert-warning mt-3">No banners yet. Add banners in Admin.</div>
  {% endif %}
  <div class="section-divider my-4"></div>
  <!-- LINHA BRILHANTE -->
  <div class="section-divider my-4"></div>
  <!-- PARA QUEM ATENDEMOS -->
  
  <section class="panel">
     
 <div class="row g-4">
  {% for a in audiences %}
  <div class="col-md-4">
    <div class="audience-card">
      <img src="{{ a.image.url }}" alt="{{ a.title }}">

      <div class="cap">
        <div class="aud-title">{{ a.title }}</div>

        {% if a.subtitle %}
          <div class="aud-sub">{{ a.subtitle }}</div>
        {% endif %}

        {% if a.order == 1 %}
          <a href="{% url 'protecao_familiar' %}" class="btn btn-outline-soft mt-2">Saber mais</a>
        {% elif a.order == 2 %}
          <a href="{% url 'planejamento_filhos' %}" class="btn btn-outline-soft mt-2">Saber mais</a>
        {% elif a.order == 3 %}
          <a href="{% url 'estrategia_empresarios' %}" class="btn btn-outline-soft mt-2">Saber mais</a>
        {% else %}
          <a href="#" class="btn btn-outline-soft mt-2">Saber mais</a>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>
  <!-- LINHA BRILHANTE -->
  <div class="section-divider my-4"></div>
  
  <!-- CARDS DINÂMICOS -->
  <section class="panel">
    <div class="panel-title">Para Quem Atendemos</div>
    <div class="panel-subtitle">Atendimento com excelência, em português.</div>

    <div class="row g-4 mt-2">
      {% if cards %}
        {% for c in cards %}
        <div class="col-md-6 col-lg-4">
          <div class="premium-card h-100">
            {% if c.image %}
              <img class="premium-card__img" src="{{ c.image.url }}" alt="{{ c.title }}">
            {% endif %}
            <div class="premium-card__body">
              <div class="premium-card__meta">
                <div class="premium-icon">✔</div>
                <div class="premium-card__title">{{ c.title }}</div>
              </div>
              <p class="premium-card__desc">{{ c.description }}</p>
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="col-12">
          <div class="alert alert-info">No cards yet. Add cards in Admin.</div>
        </div>
      {% endif %}
    </div>

  <!-- DEPOIMENTOS -->
  <section class="panel">
    <div class="panel-title text-center">Depoimentos de Clientes</div>
    <div class="panel-subtitle text-center">Confiança construída com resultado.</div>

    <div class="row g-4 mt-3">
      {% for t in testimonials %}
        <div class="col-md-4">
          <div class="p-4 rounded"
               style="background: rgba(255,255,255,.08);
                      border:1px solid rgba(212,175,55,.55);
                      box-shadow: 0 10px 30px rgba(0,0,0,.25);">

            <div class="d-flex align-items-center gap-3 mb-3">
              {% if t.photo %}
                <img src="{{ t.photo.url }}" alt="{{ t.name }}"
                     style="width:52px;height:52px;border-radius:50%;object-fit:cover;border:2px solid #aaa4a4;">
              {% endif %}
              <div>
                <div style="font-weight:900; color:#fff; text-shadow:0 1px 6px rgba(0,0,0,.45);">
                  {{ t.name }}
                </div>

                <div style="color:#D4AF37;">
                  {% for _ in "12345" %}
                    {% if forloop.counter <= t.rating %}★{% else %}☆{% endif %}
                  {% endfor %}
                </div>
              </div>
            </div>

            <div style="margin-top:10px; color:rgba(255,255,255,.92); line-height:1.35; text-shadow:0 1px 6px rgba(0,0,0,.35);">
              “{{ t.text }}”
            </div>

          </div>
        </div>
      {% empty %}
        <div class="col-12 text-center" style="opacity:.7;">
          Ainda não temos depoimentos publicados.
        </div>
      {% endfor %}
    </div>

  </section>

 <!-- LINHA BRILHANTE -->
  <div class="section-divider my-4"></div>

  <!-- SEGURADORA PARCEIRA -->
  <section class="panel partner-panel">
    <div class="partner-wrap">

      <div class="partner-logo-box">
        <img
          src="{% static 'website/img/national-life-group.png' %}"
          alt="National Life Group"
          class="partner-logo"
        >
      </div>

      <div class="partner-text">
        <div class="panel-title">Empresa que representamos</div>
        <div class="panel-subtitle partner-desc">
          A <strong>National Life Group</strong> é uma seguradora americana com mais de
          <strong>170 anos de história</strong>, reconhecida pela solidez financeira,
          confiança no mercado e compromisso em proteger famílias e empresas.
          <br><br>
          A empresa oferece soluções modernas de seguro de vida com benefícios em vida,
          estratégias de proteção patrimonial e planejamento financeiro de longo prazo,
          ajudando clientes a construir segurança, estabilidade e crescimento financeiro em dólar.
          <br><br>
          Com presença nacional nos Estados Unidos e forte reputação de credibilidade,
          a National Life Group combina tradição, inovação e atendimento humano para garantir
          tranquilidade hoje e proteção para o futuro.
        </div>
      </div>

    </div>
  </section>
<!-- LINHA BRILHANTE -->
  <div class="section-divider my-4"></div>
  <section class="panel mt-4">
    <div class="panel-title text-center">Vídeos de Depoimentos</div>
    <div class="panel-subtitle text-center">Veja pessoas reais contando a experiência.</div>

    {% if video_testimonials %}
      <div class="row g-4 mt-3">
        {% for v in video_testimonials %}

          {# ✅ LIMPA O ID mesmo se no admin você colar a URL #}
          {% with vid=v.youtube_id|cut:'https://youtu.be/'|cut:'https://www.youtube.com/watch?v='|cut:'watch?v='|cut:'https://www.youtube.com/shorts/'|cut:'https://youtube.com/shorts/'|cut:'&'|cut:'?'|slice:':11' %}
          <div class="col-md-6 col-lg-4">
            <div class="p-3 rounded" style="background: rgba(255,255,255,.03); border:1px solid rgba(212,175,55,.25);">
              {% if v.title %}
                <div style="font-weight:800; margin-bottom:10px;">{{ v.title }}</div>
              {% endif %}

              <div class="ratio ratio-16x9" style="border-radius:12px; overflow:hidden;">
                <iframe
                  src="https://www.youtube-nocookie.com/embed/{{ vid }}?rel=0&modestbranding=1&playsinline=1"
                  title="{{ v.title|default:'Vídeo' }}"
                  loading="lazy"
                  referrerpolicy="strict-origin-when-cross-origin"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  allowfullscreen>
                </iframe>
              </div>

              {# ✅ FALLBACK PROFISSIONAL: sempre oferece abrir no YouTube #}
              <div class="mt-2 d-flex gap-2 flex-wrap">
                <a class="btn btn-outline-light btn-soft"
                   href="https://www.youtube.com/watch?v={{ vid }}"
                   target="_blank" rel="noopener">
                  Assistir no YouTube
                </a>
              </div>

              <div class="mt-2" style="opacity:.65; font-size:.9rem;">
               
              </div>
            </div>
          </div>
          {% endwith %}

        {% endfor %}
      </div>
    {% else %}
      <div class="text-center mt-3" style="opacity:.7;">Ainda não há vídeos publicados.</div>
    {% endif %}
  </section>

  <!-- GALERIA -->
  <section class="panel mb-4">
    <div class="d-flex align-items-end justify-content-between gap-3 flex-wrap">
      <div>
        <div class="panel-title">Galeria</div>
        <div class="panel-subtitle">Uma breve visão da nossa abordagem centrada no cliente..</div>
      </div>
      <a class="btn btn-outline-light btn-soft" href="/contact/">Fale Conosco</a>
    </div>

    <div class="row g-3 mt-3">
      {% if gallery %}
        {% for g in gallery %}
        <div class="col-6 col-md-4 col-lg-3">
          <img class="gallery-img" src="{{ g.image.url }}" alt="{{ g.title }}">
        </div>
        {% endfor %}
      {% else %}
        <div class="col-12">
          <div class="alert alert-info">No gallery images yet. Add images in Admin.</div>
        </div>
      {% endif %}
    </div>
  </section>

</div>
{% endblock %}